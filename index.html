<script>
    import Visual from "./visual.svelte";


    import { onMount } from 'svelte';
    import MontyHallVisualization from './MontyHallVisualization.svelte';
    import * as d3 from 'd3';
  
    let count, index, offset, progress;
    
    // Game state
    let doors = [1, 2, 3];
    let chosenDoor = null;
    let winningDoor = null;
    let hostDoor = null;
    let switched = false;
    let result = null;
    let revealed = false;
    let doorSwitched = false;
  
    // Images
    let doorImage = '/door.png';  // Path to the door image in the static directory
    let goatImage = '/goat.png';  // Path to the goat image in the static directory
    let carImage = '/car.png';    // Path to the car image in the static directory
  
    const chooseDoor = (door) => {
      chosenDoor = door;
      hostDoor = doors.find(d => d !== chosenDoor && d !== winningDoor);
    };
  
    const switchDoor = () => {
      chosenDoor = doors.find(d => d !== chosenDoor && d !== hostDoor);
      switched = true;
      doorSwitched = true;
    };
  
    const reveal = () => {
      result = chosenDoor === winningDoor ? 'Win' : 'Lose';
      revealed = true;
    };
  
    const resetGame = () => {
      chosenDoor = null;
      winningDoor = doors[Math.floor(Math.random() * doors.length)]; // Randomize winning door
      hostDoor = null;
      switched = false;
      result = null;
      revealed = false;
      doorSwitched = false;
    };
  
    onMount(resetGame);
  </script>
  
  <style>
    .small-visualization {
  width: 80%; /* Adjust width as needed */
  max-width: 500px; /* Set a maximum width if needed */
  margin: 0 auto; /* Center the visualization horizontally */
}
   .section {
    height: 100vh; /* Full height of the viewport */
    overflow-y: auto; /* Enable scrolling within each section */
    display: flex; /* Use flexbox to center content vertically */
    flex-direction: column; /* Stack content vertically */
    justify-content: center; /* Center content horizontally */
    align-items: center; /* Center content vertically */
    text-align: center; /* Center text horizontally */
    padding: 20px; /* Add padding for better readability */
    background: linear-gradient(to bottom, #ff7e5f, #feb47b); /* Gradient background */
    color: white; /* Text color for better readability against gradient */
  }

  .section h2 {
    font-size: 2.5rem; /* Larger font size for headings */
  }

  .section p {
    font-size: 1.5rem; /* Larger font size for paragraphs */
  }

.doors {
      display: flex;
      justify-content: center;
      gap: 20px;
    }
  
.door {
      cursor: pointer;
    }
  
    .door img {
      width: 100px;
      height: 150px;
    }
  
    .hidden {
      display: none;
    }
  
    #histogram {
      margin-top: 20px; /* Ensures spacing below the text */
    }
  </style>
  
  <div class="section">
    <div>
        <img src="/monty.png" alt="Monty Hall" style="width: 500px; height: auto;" />
      <h2>Welcome to the Monty Hall Problem!</h2>
    </div>
    <div class="content">
      <p>The Monty Hall problem is a brain teaser, in the form of a probability puzzle, 
        based nominally on the American television game show Let's Make a Deal and named 
        after its original host, Monty Hall.</p>
        <p>Suppose you're on a game show, and you're given the choice of three doors: 
            Behind one door is a car; behind the others, goats. You pick a door, say No. 1, 
            and the host, who knows what's behind the doors, opens another door, say No. 3, 
            which has a goat. He then says to you, "Do you want to pick door No. 2?" Is it to
             your advantage to switch your choice?</p>
    </div>
  </div>
  
  <div class="section">
    <div>
      <h2>Iteration of the Game</h2>
    </div>
    <div class="content">
      {#if !chosenDoor}
        <p>Choose a door:</p>
        <div class="doors">
          {#each doors as door}
            <div class="door" on:click={() => chooseDoor(door)}>
              <img src={doorImage} alt={`Door ${door}`} />
            </div>
          {/each}
        </div>
      {:else if !result}
        <p>Host opens door {hostDoor}.</p>
        <div class="doors">
          {#each doors as door}
            <div class="door" on:click={() => chosenDoor === door && !revealed ? reveal() : null}>
              {#if door === hostDoor}
                <img src={goatImage} alt="Goat" />
              {:else if revealed && door === chosenDoor}
                <img src={door === winningDoor ? carImage : goatImage} alt={door === winningDoor ? 'Car' : 'Goat'} />
              {:else}
                <img src={doorImage} alt={`Door ${door}`} />
              {/if}
            </div>
          {/each}
        </div>
        {#if !doorSwitched}
          <button on:click={switchDoor}>Switch Door</button>
        {/if}
        <button on:click={reveal}>Reveal</button>
      {:else}
        <p>You {result}!</p>
        <div class="doors">
          {#each doors as door}
            <div class="door">
              {#if door === chosenDoor}
                <img src={door === winningDoor ? carImage : goatImage} alt={door === winningDoor ? 'Car' : 'Goat'} />
              {:else if door === hostDoor}
                <img src={goatImage} alt="Goat" />
              {:else}
                <img src={door === winningDoor ? carImage : goatImage} alt={door === winningDoor ? 'Car' : 'Goat'} />
              {/if}
            </div>
          {/each}
        </div>
        <button on:click={resetGame}>Play Again</button>
      {/if}
    </div>
  </div>
  
  <div class="section">
    <div>
      <h2>Conditional Probability</h2>
    </div>
    <div class="content">
      <p>The Monty Hall problem is a two-step decision problem that involves conditional probabilities. 
        The first step is choosing from three equally likely options, and the second step is made after one of 
        the options is eliminated. The mathematical analysis of the Monty Hall problem considers 
        the probability of the car being behind a door before the host opens it, and the 
        probability of winning after switching doors:</p>

        <p>Before the host opens a door:</p>

        <p>Before the host opens a door, there is a 1/3 probability that the car is behind each door</p>

        <p>After the host opens a door:</p>

            <p>If the host opens a door with a goat behind it, 
            the probability of winning after switching doors is 1/2. 
            This is because there are two remaining doors to choose from, 
            and one of them must have the car. In two out of three cases, 
            switching doors will result in winning the car because it's more 
            likely to choose a door with a goat behind it first, and the host will
             then reveal that one of the other doors has a goat.</p>
    </div>
  </div>
  
  
  <div class="section">
    <MontyHallVisualization />
  </div>

  <div class="section">
  <div class="content">
    <div class="small-visualization">
      <Visual />
    </div>
  </div>
</div>
  
  <div class="section">
    <div>
      <h2>Conclusion</h2>
    </div>
    <div class="content">
      <p>The given probabilities depend on specific assumptions about how the host and 
        contestant choose their doors. An important insight is that, with these standard
         conditions, there is more information about doors 2 and 3 than was available at 
         the beginning of the game when door 1 was chosen by the player: the host's action adds
          value to the door not eliminated, but not to the one chosen by the contestant originally. 
          Another insight is that switching doors is a different action from choosing between the two 
          remaining doors at random, as the former action uses the previous information and the latter 
          does not. Other possible behaviors of the host than the one described can reveal different 
          additional information, or none at all, and yield different probabilities.</p>
    </div>
  </div>
  
